<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      xmlns:tal="http://xml.zope.org/namespaces/tal" lang="en-US"
      i18n:domain="plone">
  <head>
    <metal:block metal:define-macro="jshead">
      <script type="text/javascript" src="http://pleiades.stoa.org/ol/lib/OpenLayers.js"></script>
      <script type="text/javascript" src="ol.js"
        tal:attributes="src string:${context/absolute_url}/ol.js"></script>
    </metal:block>
  </head>
  <body>
  
    <div metal:define-macro="mapzone" id="mapzonebox"
      tal:define="query_results python:context.portal_catalog.searchResults(path='/plone/default-map')"
      tal:condition="python:len(query_results) > 0"
      >
      <div id="map" style="float:right;width:600px;height:300px;border:solid gray 1px;background-color:#cccccc;"></div>
      <script
        tal:define="mapcontext python:getattr(context.plone, 'default-map');
                    map_json string:${mapcontext/json};"
        defer="defer"
        type="text/javascript"
        tal:content="python:''' 
        var map = eval('(%s)');
        mapContents(map);
        ''' % (map_json)"
        >
      </script>
    </div>

  </body>
</html>
