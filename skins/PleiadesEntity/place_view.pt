<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  lang="en"
  metal:use-macro="here/main_template/macros/master"
  i18n:domain="plone"
  >

<metal:javascript fill-slot="javascript_head_slot">
<script
  src="key"
  tal:attributes="src string:http://maps.google.com/maps?file=api&amp;v=2&amp;key=${context/@@ol-gmaps-key}"
  type="text/javascript"
  >
</script>
<script src="http://openlayers.org/api/OpenLayers.js"></script>
<script
  type="text/javascript"
  src="../@@ol.js"
  tal:attributes="src string:${context/absolute_url}/@@ol.js"
  >
</script>
<script type="text/javascript">
  var map, base, marker, coords;
  var SHADOW_Z_INDEX = 10;
  var MARKER_Z_INDEX = 11;
        
  function init() {
    map = new OpenLayers.Map('map');
    base = new OpenLayers.Layer.Google(
                "Base", {   
                    isBaseLayer: true,
                    type: G_PHYSICAL_MAP, 
                    //sphericalMercator: true
                    }
                );
    marker = new OpenLayers.Layer.Vector(
                "Marker",
                {
                    styleMap: new OpenLayers.StyleMap({
                        externalGraphic: "http://openlayers.org/dev/img/marker-gold.png",
                        backgroundGraphic: "http://openlayers.org/dev/examples/marker_shadow.png",
                        backgroundXOffset: 0,
                        backgroundYOffset: -7,
                        graphicZIndex: MARKER_Z_INDEX,
                        backgroundGraphicZIndex: SHADOW_Z_INDEX,
                        pointRadius: 10
                    }),
                    reproject: true,
                    isBaseLayer: false,
                    projection 
                    rendererOptions: {yOrdering: true}
                }
            );
    coords = pleiades_oljs.centroid.coordinates;
    map.addLayers([base, marker]);
    //map.addControl(new OpenLayers.Control.LayerSwitcher());
    map.setCenter(new OpenLayers.LonLat(coords[0], coords[1]), 5);
    marker.features.push(
                    new OpenLayers.Feature.Vector(
                        new OpenLayers.Geometry.Point(coords[0], coords[1])
                    )
                );
  }
</script>
</metal:javascript>

<body>
<metal:main fill-slot="main">
  <tal:main-macro 
    metal:define-macro="main"
    tal:define="
        kssClassesView context/@@kss_field_decorator_view;
        getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
        templateId template/getId;
        text here/getContent;"
        >

    <div tal:replace="structure provider:plone.abovecontenttitle" />

    <h1 class="documentFirstHeading"> 
      <metal:field use-macro="python:context.widget('title', mode='view')">
      Title
      </metal:field>
    </h1>

    <div tal:replace="structure provider:plone.belowcontenttitle" />

    <div id="map" style="float:right;width:200px;height:300px;border:solid gray 1px;background-color:#cccccc;margin-left:1em;"></div>
    <script defer="defer" type="text/javascript">
      init();
    </script>

    <div id="non-map" style="float:left">

    <p class="documentDescription">
      <metal:field
        use-macro="python:context.widget('description', mode='view')"
        >
      Description
      </metal:field>
    </p>

    <p class="field">
      <label><span>Modern Location</span>:</label>
      <metal:field
        use-macro="python:context.widget('modernLocation', mode='view')"
        >
      Description
      </metal:field>
    </p>

    <div class="field" id="pleiades-features">
      <label><span>Features</span>:</label>
      <p
        metal:use-macro="context/pleiades_featurelisting/macros/contentlisting"
        >
        features
      </p>
    </div>

    </div>
    <hr style="display: block; clear: right; visibility: hidden;"/>

    <div tal:replace="structure provider:plone.abovecontentbody" />

    <p 
      tal:condition="python: not text and is_editable"
      i18n:translate="no_body_text"
      class="discreet"
      >
      This item does not have any body text, click the edit tab to change it.
    </p>

    <metal:field use-macro="python:context.widget('content', mode='view')">
      Body text
    </metal:field>

    <div metal:use-macro="here/document_relateditems/macros/relatedItems">
      show related items if they exist
    </div>

    <div tal:replace="structure provider:plone.belowcontentbody" />

  </tal:main-macro>
</metal:main>
</body>

</html>

