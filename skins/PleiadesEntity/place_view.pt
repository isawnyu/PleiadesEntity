<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="plone">
  
  <head>
    
    <metal:links_macro metal:define-macro="links"
      tal:define="url context/absolute_url"
      >
      <link rel="alternate" tal:attributes="href string:${url}#this"/>
      <link rel="alternate" type="application/atom+xml" tal:attributes="href string:${url}/atom"/>
      <link rel="alternate" type="application/json" tal:attributes="href string:${url}/@@json?sm=1"/>
      <link rel="alternate" type="application/vnd.google-earth.kml+xml" tal:attributes="href string:${url}/kml"/>
    </metal:links_macro>
    
    <metal:js_macro metal:define-macro="js">
      <script type="text/javascript" src="key" tal:attributes="src string:http://maps.google.com/maps?file=api&amp;v=2&amp;key=${context/@@ol-gmaps-key}"></script>
      <script type="text/javascript" src="http://openlayers.org/api/OpenLayers.js"></script>
      <script type="text/javascript" src="++resource++ol-map.js"></script>
    </metal:js_macro>
  
  </head>
  
  <body>
    
    <metal:body_macro
      metal:define-macro="body"
      tal:define="field_macro field_macro | here/widgets/field/macros/view;
        kssClassesView context/@@kss_field_decorator_view;
        getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
        templateId template/getId;"
        >
      
      <div id="map" style="width:485px;height:300px;border:solid gray 1px;background-color:#cccccc;margin-bottom:1.5em;"></div>
      
      <script defer="defer" type="text/javascript">
        initMap();
        function setZoom() {
            var extent = vectors.getDataExtent();
            extent.left -= 5000.0;
            extent.right += 5000.0;
            extent.top += 5000.0;
            extent.bottom -= 5000.0;
            map.zoomToExtent(extent);
        }
        jq(document).ready(setZoom);
      </script>
      <br/>

        <p class="documentDescription">
            <metal:field use-macro="python:here.widget('description', mode='view')">
            Description
            </metal:field>
        </p>
      
      <tal:repeat
        repeat="field python:here.Schema().filterFields(isMetadata=0)"
        >
        <tal:if_visible
          define="mode string:view; visState python:field.widget.isVisible(here, mode); visCondition python:field.widget.testCondition(here, portal, template);"
          condition="python:visState == 'visible' and visCondition">
          <metal:use_field use-macro="field_macro"/>
        </tal:if_visible>
      </tal:repeat>

            <hr/>
            <!-- Names -->
            <div>
                <h4>Ancient Names</h4>
                <ul tal:repeat="data context/@@attestations/names">
                    <li tal:define="n python:data[0]; tps python:'(%s)' % ', '.join([a['timePeriod'].capitalize() for a in data[1]])"><a href="" tal:attributes="href n/getId" tal:content="n/title_or_id"></a> <span tal:content="tps"></span></li>
                </ul>
            </div>
                  
      <div>
      <h4>Alternate representations</h4>
      <p tal:define="url context/absolute_url">
          <a type="application/atom+xml" tal:attributes="href string:${url}/atom">Atom</a>,
          <a type="application/json" tal:attributes="href string:${url}/json">JSON</a>,
          <a type="application/vnd.google-earth.kml+xml" tal:attributes="href string:${url}/kml">KML</a>
      </p>
    
    </metal:body_macro>
    
    <metal:folderlisting_macro define-macro="folderlisting">
      <!-- nothing -->
    </metal:folderlisting_macro>
  
  
  </body>
</html>
