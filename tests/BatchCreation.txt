BatchCreation.txt
=====================

Test batch creation of Place objects. The values against which verifications are performed in these tests are loaded from the xml file batlas-65-2-24.xml, located in Place/tests/data. We begin by loading from file, and thoroughly testing, a single entity. Then, we batch load all the xml files in Place/tests/data and perform some basic tests (counting, checking ids), but -- for now at least -- we do not test everything derived from every single file.

A lot of this is cribbed from optilude's tutorial on plone.org.

Setup the test fixture
    >>> folder = self.folder

Utility test

    >>> format_listofstrings([])
    u''
    >>> format_listofstrings(['x'])
    u'x'
    >>> format_listofstrings(['x', 'y'])
    u'x and y'
    >>> format_listofstrings(['x', 'y', 'z'])
    u'x, y and z'
    
    >>> purifyText(u'aaa') == u'aaa'
    True
    >>> purifyText(u'abab') == u'abab'
    True
    >>> purifyText(u'Magie\U000000A01950,\U000000A0989') == u'Magie 1950, 989'
    True
    
Test loading

    >>> import glob
    >>> import os

Load a whole batch of entities

    >>> loaden(folder, TEST_DATA)
    'Loaded 14 of 15 files. Failures:\nbatlas-99-9-99.xml\n'

Check count of created entities

    >>> entities = folder.listFolderContents()
    >>> len(entities)
    14
    
Check ids of created entities

    >>> en_ids = []
    >>> for entity in entities: en_ids.append(entity.getId())
    >>> 'batlas-65-2-3' in en_ids
    True
    >>> 'batlas-65-2-4' in en_ids
    True
    >>> 'batlas-65-2-12' in en_ids
    True
    >>> 'batlas-65-2-19' in en_ids
    True
    >>> 'batlas-65-2-20' in en_ids
    True
    >>> 'batlas-65-2-22' in en_ids
    True
    >>> 'batlas-65-2-24' in en_ids
    True
    >>> 'batlas-65-2-24-grc' in en_ids
    True
    >>> 'batlas-65-4-3' in en_ids
    True
    >>> 'batlas-65-4-9' in en_ids
    True
    >>> 'batlas-65-7-3' in en_ids
    True
    >>> 'batlas-65-7-56' in en_ids
    True
    >>> 'batlas-65-7-59' in en_ids
    True
    >>> 'batlas-65-8-3' in en_ids
    True
    >>> 'batlas-99-9-99' in en_ids
    False

Check creation of names

	>>> entity = getattr(folder, 'batlas-65-2-20')
	>>> names = entity.listFolderContents()
    >>> len(names)
    2

