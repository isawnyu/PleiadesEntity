
Name Views
==========

Setup
-----

    >>> lpf = self.portal.portal_types['Large Plone Folder']
    >>> lpf_allow = lpf.global_allow
    >>> lpf.global_allow = True

    >>> n = self.portal.portal_types['Name']
    >>> n_allow = n.global_allow
    >>> n.global_allow = True

    >>> folder = self.folder

    >>> _ = folder.invokeFactory('Large Plone Folder', id='names')
    >>> _ = folder.names.invokeFactory('Name', id='neverpolis')
    >>> n = getattr(folder.names, 'neverpolis')


Check base view with test browser
---------------------------------

Initialize the test browser

    >>> from Products.Five.testbrowser import Browser
    >>> browser = Browser()
    >>> browser.handleErrors = False

Log all exceptions, which is useful for debugging. Also, clear portlet slots,
to make the test browser less confused by things like the recent portlet and
the navtree.

    >>> self.portal.error_log._ignored_exceptions = ()
    >>> self.portal.left_slots = self.portal.right_slots = []

Browse the Name

    >>> url = n.absolute_url()
    >>> browser.open(url)

Check the URL 

    >>> browser.url == url
    True
    >>> browser.url.endswith('neverpolis')
    True
    
Check the html content of the view page (description will not appear here)
    
    >>> browser.contents
    '...Name as Attested...'
    
    >>> browser.contents
    '...Transliterated name...'
    
    >>> browser.contents
    '...Language and Writing System...'
    
    >>> browser.contents
    '...Name type...'
    
    >>> browser.contents
    '...Accuracy of Attestation...'
    
    >>> browser.contents
    '...Completeness of Attestation...'
    
    >>> browser.contents
    '...Temporal attestations...'
    
    >>> browser.contents
    '...Primary References...'
    
    >>> browser.contents
    '...Secondary references...'
    
Edit the name, modify the attestation using legal characters and language to verify validation

    >>> browser.getLink('Log in').click()
    >>> browser.getControl('Login Name').value = 'test_user_1_'
    >>> browser.getControl('Password').value = 'secret'
    >>> browser.getControl('Log in').click()
    >>> url = url + '/base_edit'
    >>> browser.open(url)
    >>> control = browser.getControl(name='nameAttested')
    >>> control.value = 'Innoxium Municipium'
    >>> control = browser.getControl(name='nameLanguage')
    >>> control.value = ['la']
    >>> browser.getControl(name='form_submit').click()
    >>> browser.contents
    '...Changes saved...'

Edit the name again, modify the attestation using illegal characters and language to verify validation

    >>> url = url + '/base_edit'
    >>> browser.open(url)
    >>> control = browser.getControl(name='nameAttested')
    >>> control.value = 'Municipium Noxium Maximum'
    >>> control = browser.getControl(name='nameLanguage')
    >>> control.value = ['grc']
    >>> browser.getControl(name='form_submit').click()
    >>> browser.contents
    '...23 invalid character(s) in name Municipium Noxium Maximum...'
