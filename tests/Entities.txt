
Tests of relationships among Name, Location, and Place
======================================================

Setup
-----

    Check catalogs

    >>> uc = self.portal.uid_catalog
    >>> rc = self.portal.reference_catalog

    Enable types

    >>> lpf = self.portal.portal_types['Large Plone Folder']
    >>> lpf_allow = lpf.global_allow
    >>> lpf.global_allow = True

    >>> n = self.portal.portal_types['Name']
    >>> n_allow = n.global_allow
    >>> n.global_allow = True

    Alias the test folder

    >>> folder = self.folder

    Containers

    >>> _ = folder.invokeFactory('Large Plone Folder', id='names')
    >>> _ = folder.invokeFactory('LocationContainer', id='locations')
    >>> _ = folder.invokeFactory('PlaceContainer', id='places')
    >>> names = folder.names
    >>> locations = folder.locations
    >>> places = folder.places

    Entities

    >>> _ = names.invokeFactory('Name', id='civitasnon', title='Civitas Non', nameTransliterated='Civitas Non', nameAttested='Civitas Non', nameLanguage='la', nameType='geographic')
    >>> lid = locations.invokeFactory('Location')
    >>> pid = places.invokeFactory('Place')
    >>> p = getattr(folder.places, pid)
    >>> aid = p.invokeFactory('PlacefulAssociation', id="civitasnon-%s" % lid)

    Add References

    >>> n = getattr(names, 'civitasnon')
    >>> x = getattr(locations, lid)
    >>> a = getattr(p, aid)
    >>> _ = a.addReference(n, 'hasName')
    >>> _ = a.addReference(x, 'hasLocation')

    Set location coordinates

    >>> _ = x.setSpatialCoordinates('34.769722222222 -86.4808333333333 0.0')

Test the geo adapters
---------------------

    >>> from Products.PleiadesGeocoder.interfaces import IGeoItemSimple, IGeoCollectionSimple

    Place Association

    >>> g = IGeoItemSimple(a)
    >>> g.isGeoreferenced()
    True
    >>> gi = g.__geo_interface__
    >>> gi['type']
    'Feature'
    >>> gi['geometry']['type']
    'Point'
    >>> gi['geometry']['coordinates']
    (-86.480833333333294, 34.769722222222001, 0.0)

    Place

    >>> g = IGeoItemSimple(p)
    >>> g.isGeoreferenced()
    True
    >>> gi = g.__geo_interface__
    >>> gi['type']
    'Feature'
    >>> gi['geometry']['type']
    'Point'
    >>> gi['geometry']['coordinates']
    (-86.480833333333294, 34.769722222222001, 0.0)
    >>> gi['properties']['title']
    'Civitas Non'

    >>> c = IGeoCollectionSimple(places)
    >>> x = list(c.geoItems())
    >>> len(x)
    1

