
Tests of relationships among Name, Location, and Place
======================================================

Setup
-----

    Check catalogs

    >>> uc = self.portal.uid_catalog
    >>> rc = self.portal.reference_catalog

    Enable types

    >>> lpf = self.portal.portal_types['Large Plone Folder']
    >>> lpf_allow = lpf.global_allow
    >>> lpf.global_allow = True

    >>> n = self.portal.portal_types['GeographicName']
    >>> n_allow = n.global_allow
    >>> n.global_allow = True

    Alias the test folder

    >>> folder = self.folder

    Containers

    >>> _ = folder.invokeFactory('Large Plone Folder', id='names')
    >>> _ = folder.invokeFactory('LocationContainer', id='locations')
    >>> _ = folder.invokeFactory('PlaceContainer', id='places')

    Entities

    >>> _ = folder.names.invokeFactory('GeographicName', id='neverpolis', title='Neverpolis')
    >>> lid = folder.locations.invokeFactory('Location')
    >>> pid = folder.places.invokeFactory('Place')

    Add References

    >>> n = folder.names.neverpolis
    >>> x = getattr(folder.locations, lid)
    >>> p = getattr(folder.places, pid)
    >>> _ = p.addReference(n, 'name_name')
    >>> _ = p.addReference(x, 'location_location')

    Set location coordinates

    >>> _ = x.setSpatialCoordinates('34.769722222222 -86.4808333333333 0.0')

Test the geo adapters
---------------------

    >>> from Products.PleiadesGeocoder.interfaces import IGeoItemSimple, IGeoCollectionSimple

    >>> g = IGeoItemSimple(p)
    >>> g.isGeoreferenced()
    True
    >>> g.getInfo() == {'srs': 'EPSG:4326', 'geometryType': 'point', 'description': '', 'spatialCoordinates': '34.7697222222 -86.4808333333 0.0', 'url': 'http://nohost/plone/Members/test_user_1_/places/%s' % pid, 'title': 'Neverpolis', 'id': pid}
    True

    >>> c = IGeoCollectionSimple(folder.places)
    >>> c.getItemsInfo() == [{'srs': 'EPSG:4326', 'geometryType': 'point', 'description': '', 'spatialCoordinates': '34.7697222222 -86.4808333333 0.0', 'url': 'http://nohost/plone/Members/test_user_1_/places/%s' % pid, 'title': 'Neverpolis', 'id': pid}]
    True
